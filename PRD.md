# 旅行支出管理アプリ - Product Requirements Document (PRD)

## 1. プロジェクト概要

### プロダクト名
**Travel Expense Tracker（旅行支出トラッカー）**

### 概要
海外旅行者が現地での支出を簡単に記録・管理できるクロスプラットフォームアプリケーション。レシート/領収書のOCR読み取り機能により、手軽に支出を記録し、旅行ごとに予算管理と支出分析ができる。

### ビジョン
旅行中のお金の管理を簡単にし、旅行者が予算を気にせず安心して旅を楽しめるようにする。

---

## 2. 目的とゴール

### ビジネスゴール
- 海外旅行者の支出管理の課題を解決する
- MVP版をリリースし、ユーザーフィードバックを収集する
- 将来的に為替対応やグループ旅行機能で差別化を図る

### ユーザーゴール
- 旅行中の支出を簡単に記録したい
- レシートをスキャンするだけで記録できる便利さ
- 旅行ごとに予算管理し、使いすぎを防ぎたい
- 旅行後に支出を振り返り、次回の計画に活かしたい

---

## 3. ターゲットユーザー

### プライマリーユーザー
- **年齢**: 20代〜40代
- **属性**: 海外旅行を年1回以上する個人旅行者
- **ニーズ**:
  - 現地通貨での支出管理が面倒
  - レシートを溜め込んで後で集計するのが大変
  - 予算オーバーしないか不安

### ユースケース
1. バックパッカーが各国での支出を記録
2. ビジネス出張者が経費精算のためにレシートを管理
3. 家族旅行で予算内に収めたい親御さん

---

## 4. MVP機能詳細

### 4.1 認証・アカウント管理
- **ユーザー登録/ログイン** (Supabase Auth)
  - メールアドレス + パスワード
  - ソーシャルログイン（Google、Apple）
- **プロフィール管理**
  - 基本情報（名前、プロフィール画像）

### 4.2 オンボーディング

#### 初回起動時のチュートリアル
新規ユーザーがアプリを初めて起動したときに表示される、使い方を説明するフロー。

#### ウェルカム画面（スプラッシュ）
- **アプリのロゴとキャッチコピー**
  - 「旅行中の支出を簡単に管理」
  - 赤を基調としたビジュアル
- **開始ボタン**: 次の画面へ

#### 主要機能紹介スライド（3-4画面）

**スライド1: レシートスキャン機能**
- **イラスト/アニメーション**: レシートをカメラでスキャンする様子
- **見出し**: 「📸 レシートを撮るだけ」
- **説明**: 「レシートをカメラで撮影するだけで、金額や日付を自動で記録します」

**スライド2: 旅行管理機能**
- **イラスト/アニメーション**: 旅行カードのビジュアル
- **見出し**: 「🗺️ 旅行ごとに管理」
- **説明**: 「各旅行を個別に管理。どこで何にお金を使ったか一目で分かります」

**スライド3: 予算トラッキング**
- **イラスト/アニメーション**: 予算ゲージのビジュアル
- **見出し**: 「💰 予算をリアルタイム管理」
- **説明**: 「予算を設定すれば、残りいくら使えるか常に確認できます」

**スライド4: レポート機能**
- **イラスト/アニメーション**: グラフやチャートのビジュアル
- **見出し**: 「📊 支出を見える化」
- **説明**: 「カテゴリー別、日別のグラフで旅行の支出を振り返れます」

#### パーミッション許可リクエスト
- **カメラアクセス許可**:
  - 「レシートを撮影するために、カメラへのアクセスを許可してください」
  - スキップ可能（後で設定可能）

- **通知許可（オプション）**:
  - 「予算アラートを受け取るために、通知を有効にしますか？」
  - スキップ可能

#### 初期設定（オプション）
- **ホーム通貨の設定**（日本円、米ドルなど）
  - 将来の為替対応に備えて
  - スキップ可能（デフォルト: 日本円）

#### 最初の旅行作成を促す
- **CTA（Call to Action）**:
  - 大きなボタン「最初の旅行を作成する」
  - または「後で作成」でホーム画面へ

#### オンボーディング完了フラグ
- **ユーザーデータに保存**:
  - `onboarding_completed: true`
  - 2回目以降の起動時は表示しない
- **再表示オプション**:
  - 設定画面から「チュートリアルを再表示」可能

#### UXガイドライン
- **スキップ可能**: すべてのスライドはスキップできる
- **進捗インジケーター**: 現在のスライド位置を表示（1/4、2/4など）
- **アニメーション**: スムーズなページ遷移
- **所要時間**: 30秒〜1分で完了できる簡潔さ

### 4.3 旅行管理

#### 旅行の作成
- **必須項目**:
  - 旅行名（例: 「パリ旅行 2025」）
  - 目的地（国名・都市名）
  - 旅行期間（開始日・終了日）
  - 現地通貨（通貨コードと通貨記号）
  - 予算（オプション）

- **オプション項目**:
  - メモ/説明
  - カバー画像

#### 旅行一覧
- アクティブな旅行と過去の旅行を表示
- カード形式で表示（旅行名、期間、目的地、総支出）
- 並び替え（日付順、支出額順）
- 検索・フィルター機能

### 4.4 支出記録

#### レシート/領収書のOCR読み取り
- **カメラ撮影またはギャラリーから選択**
- **OCR処理**:
  - 金額の自動抽出
  - 日付の自動抽出
  - 店名/場所の自動抽出（可能な範囲で）
- **多言語対応**: 主要言語のレシートに対応
- **手動編集機能**: OCR結果を確認・修正できる画面

#### 支出の手動入力
- カメラなしでも手動で支出を追加可能
- **必須項目**:
  - 金額
  - 日付
  - 通貨（旅行の設定通貨がデフォルト）

- **オプション項目**:
  - カテゴリー（後述）
  - 支払い方法
  - タグ
  - メモ
  - 場所/店名
  - レシート画像

#### カテゴリー機能
- **デフォルトカテゴリー**:
  - 🍽️ 食事
  - 🏨 宿泊
  - 🚆 交通
  - 🎭 アクティビティ・観光
  - 🛍️ ショッピング
  - 💊 医療・健康
  - 📱 通信
  - 🎫 チケット
  - 💰 その他

- **カスタムカテゴリー**: ユーザーが独自カテゴリーを作成可能
- **色とアイコン**: 各カテゴリーに色とアイコンを設定

#### 支払い方法
- 現金
- クレジットカード
- デビットカード
- 電子マネー
- その他

#### タグ機能
- 自由なタグ付け（例: 「朝食」「お土産」「友達と」）
- タグでフィルタリング可能

#### レシート画像保存
- 各支出にレシート画像を紐付け
- 画像の拡大表示
- 複数画像の添付可能

### 4.5 予算管理

#### 旅行ごとの予算設定
- 総予算の設定
- カテゴリー別予算の設定（オプション）

#### 予算トラッキング
- **ダッシュボード表示**:
  - 総予算 vs 総支出
  - 残り予算
  - 使用率（プログレスバー）
  - 1日あたりの平均支出
  - 残り日数での1日あたり推奨予算

- **アラート機能**:
  - 予算の80%到達時に通知
  - 予算超過時に警告

### 4.6 支出レポート・分析

#### サマリー表示
- 総支出額
- 支出件数
- 平均支出額
- 最大支出額

#### カテゴリー別分析
- **円グラフ**: カテゴリー別の支出割合
- **リスト表示**: カテゴリー別の支出額と件数

#### 日別支出推移
- **折れ線グラフ**: 日ごとの支出推移
- **棒グラフ**: 日別の支出額

#### 支払い方法別分析
- 現金 vs カードなどの内訳

#### 詳細レポート画面
- フィルター機能:
  - 期間指定
  - カテゴリー
  - 支払い方法
  - タグ
- ソート機能:
  - 日付順
  - 金額順

### 4.7 支出一覧・編集

- **リスト表示**: 時系列での支出一覧
- **カード形式**: 各支出をカードで表示（金額、カテゴリー、日付、メモ）
- **編集機能**: 支出内容の修正
- **削除機能**: 支出の削除（確認ダイアログ付き）
- **検索機能**: メモや店名での検索

### 4.8 データ同期（Supabase）

- **クラウド保存**: すべてのデータをSupabaseに保存
- **リアルタイム同期**: 複数デバイス間でデータを同期
  - iOS、Android、Webアプリ間でデータ共有
- **データバックアップ**: 自動的にクラウドにバックアップ

---

## 5. 技術スタック

### フロントエンド

#### iOS
- **言語**: Swift
- **フレームワーク**: SwiftUI
- **最小サポートバージョン**: iOS 15.0以降

#### Android
- **言語**: Kotlin
- **フレームワーク**: Jetpack Compose
- **最小サポートバージョン**: Android 8.0 (API 26)以降

#### Web App
- **フレームワーク**: React + TypeScript
- **UIライブラリ**: Tailwind CSS、shadcn/ui
- **状態管理**: React Context / Zustand
- **ビルドツール**: Vite

### バックエンド
- **BaaS**: Supabase
  - 認証（Supabase Auth）
  - データベース（PostgreSQL）
  - ストレージ（画像保存）
  - リアルタイム同期

### OCR
- **iOS**: Vision Framework (Apple)
- **Android**: ML Kit (Google)
- **Web**: Tesseract.js または Cloud Vision API

### グラフ・チャート
- **共通**: Chart.js / Recharts / Victory Native

---

## 6. データモデル

### 6.1 Users（ユーザー）
```sql
users (
  id: UUID (Primary Key),
  email: String,
  display_name: String,
  profile_image_url: String,
  onboarding_completed: Boolean (Default: false),
  created_at: Timestamp,
  updated_at: Timestamp
)
```

### 6.2 Trips（旅行）
```sql
trips (
  id: UUID (Primary Key),
  user_id: UUID (Foreign Key → users),
  name: String,
  destination: String,
  start_date: Date,
  end_date: Date,
  currency_code: String (例: USD, EUR, THB),
  currency_symbol: String (例: $, €, ฿),
  total_budget: Decimal (nullable),
  cover_image_url: String (nullable),
  notes: Text (nullable),
  created_at: Timestamp,
  updated_at: Timestamp
)
```

### 6.3 Categories（カテゴリー）
```sql
categories (
  id: UUID (Primary Key),
  user_id: UUID (Foreign Key → users, nullable for default),
  name: String,
  icon: String,
  color: String (Hex),
  is_default: Boolean,
  created_at: Timestamp
)
```

### 6.4 Expenses（支出）
```sql
expenses (
  id: UUID (Primary Key),
  trip_id: UUID (Foreign Key → trips),
  user_id: UUID (Foreign Key → users),
  amount: Decimal,
  currency_code: String,
  currency_symbol: String,
  date: Date,
  category_id: UUID (Foreign Key → categories, nullable),
  payment_method: String (cash, credit_card, debit_card, e_money, other),
  merchant_name: String (nullable),
  location: String (nullable),
  notes: Text (nullable),
  receipt_image_url: String (nullable),
  created_at: Timestamp,
  updated_at: Timestamp
)
```

### 6.5 Expense_Images（支出画像）
```sql
expense_images (
  id: UUID (Primary Key),
  expense_id: UUID (Foreign Key → expenses),
  image_url: String,
  uploaded_at: Timestamp
)
```

### 6.6 Tags（タグ）
```sql
tags (
  id: UUID (Primary Key),
  user_id: UUID (Foreign Key → users),
  name: String,
  created_at: Timestamp
)
```

### 6.7 Expense_Tags（支出とタグの中間テーブル）
```sql
expense_tags (
  expense_id: UUID (Foreign Key → expenses),
  tag_id: UUID (Foreign Key → tags),
  PRIMARY KEY (expense_id, tag_id)
)
```

### 6.8 Category_Budgets（カテゴリー別予算）
```sql
category_budgets (
  id: UUID (Primary Key),
  trip_id: UUID (Foreign Key → trips),
  category_id: UUID (Foreign Key → categories),
  budget_amount: Decimal,
  created_at: Timestamp,
  updated_at: Timestamp
)
```

---

## 7. UI/UXデザイン要件

### 7.1 カラースキーム（赤基調）

#### プライマリーカラー
- **メインレッド**: `#E63946` (情熱的な赤)
- **ダークレッド**: `#C1121F` (濃い赤、ヘッダーやアクセント)
- **ライトレッド**: `#F8B4B4` (薄い赤、背景やハイライト)

#### セカンダリーカラー
- **ホワイト**: `#FFFFFF` (背景)
- **ライトグレー**: `#F8F9FA` (カード背景)
- **ミディアムグレー**: `#6C757D` (テキスト補助)
- **ダークグレー**: `#343A40` (メインテキスト)

#### アクセントカラー
- **ゴールド**: `#FFB703` (予算関連、重要な情報)
- **グリーン**: `#06D6A0` (予算内、ポジティブ)
- **オレンジ**: `#FB8500` (警告、80%達成)

### 7.2 タイポグラフィ
- **見出し**: 大胆で読みやすいフォント（例: Inter Bold, SF Pro Display）
- **本文**: 視認性の高いサンセリフ（例: Inter Regular, SF Pro Text）
- **数字**: 等幅フォント（金額表示用）

### 7.3 主要画面

#### オンボーディング画面
- **ウェルカム画面**:
  - 大きなアプリロゴ（赤基調）
  - キャッチコピー: 「旅行中の支出を簡単に管理」
  - 赤のグラデーション背景
  - 「始める」ボタン（大きく、赤色）

- **機能紹介スライド**:
  - フルスクリーン表示
  - 各スライドにイラスト/アニメーション
  - 見出し（大きく、太字）
  - 説明テキスト（2-3行）
  - 下部に進捗ドット（1/4、2/4など）
  - 「次へ」ボタンと「スキップ」リンク
  - スワイプでページ遷移可能

- **パーミッション画面**:
  - カメラアイコン
  - 説明テキスト
  - 「許可する」ボタン（赤色）
  - 「後で設定」リンク（グレー）

- **最終画面（CTA）**:
  - 「準備完了！」のメッセージ
  - 「最初の旅行を作成する」ボタン（大きく、赤色）
  - 「後で作成」リンク

#### ホーム画面
- **旅行カード一覧**:
  - 赤いグラデーション背景
  - 旅行名、期間、総支出を表示
  - 予算使用率のプログレスバー
- **フローティングアクションボタン（FAB）**:
  - 赤色の「+」ボタン
  - 新規旅行作成

#### 旅行詳細画面
- **ヘッダー**:
  - カバー画像（または赤のグラデーション）
  - 旅行名と期間
  - 編集ボタン
- **予算サマリーカード**:
  - 総予算 vs 総支出
  - 円形プログレスバー（赤〜緑のグラデーション）
  - 残り予算を大きく表示
- **タブナビゲーション**:
  - 概要
  - 支出一覧
  - レポート
- **FAB**: 支出追加（カメラアイコン）

#### 支出追加画面
- **OCR画面**:
  - カメラプレビュー
  - レシート撮影ボタン（赤色の大きな円）
  - ギャラリーから選択ボタン
- **支出編集画面**:
  - 金額入力（大きな数字キーパッド）
  - カテゴリー選択（アイコン付きチップ）
  - 日付ピッカー
  - 支払い方法選択
  - タグ入力（自動補完）
  - メモ入力
  - レシート画像プレビュー

#### レポート画面
- **サマリーカード**:
  - 赤いグラデーション背景
  - 総支出、平均支出などの数値
- **カテゴリー別円グラフ**:
  - カラフルな色分け
  - タップで詳細表示
- **日別支出グラフ**:
  - 折れ線 + 棒グラフのコンボ
  - インタラクティブなツールチップ
- **フィルター**:
  - 期間、カテゴリー、タグでフィルタリング

#### 支出一覧画面
- **リスト表示**:
  - 日付でグループ化
  - 各支出をカード表示
  - スワイプで編集/削除
- **検索バー**:
  - 店名やメモで検索

### 7.4 デザインガイドライン
- **カードデザイン**: 角丸、影付きで立体感を出す
- **アニメーション**: スムーズなトランジション（0.3s ease-in-out）
- **ボタン**: 赤色の角丸ボタン、ホバー時に濃くなる
- **アイコン**: Material Icons または SF Symbols
- **レスポンシブ**: モバイルファースト、タブレットにも対応

---

## 8. 非機能要件

### 8.1 パフォーマンス
- アプリ起動時間: 3秒以内
- OCR処理時間: 5秒以内
- 画面遷移: 0.3秒以内

### 8.2 セキュリティ
- Supabase Authでの安全な認証
- Row Level Security (RLS) でデータアクセス制御
- レシート画像は暗号化してストレージに保存

### 8.3 信頼性
- データの自動バックアップ
- エラーハンドリング（ユーザーフレンドリーなエラーメッセージ）

### 8.4 アクセシビリティ
- VoiceOver / TalkBack 対応
- カラーコントラスト比 4.5:1 以上（WCAG AA準拠）
- 大きなタップターゲット（44x44pt以上）

---

## 9. MVP以降のロードマップ

### Phase 2（MVP後の優先機能）
1. **為替レート対応**:
   - 複数通貨の自動変換
   - リアルタイム為替レート取得
   - ホーム通貨での総計表示

2. **オフライン対応**:
   - ローカルデータベース（SQLite / Realm）
   - オフラインでの支出記録
   - ネット接続時に自動同期

3. **エクスポート機能**:
   - PDF/CSV形式でのレポート出力
   - メール送信機能

### Phase 3（将来的な拡張機能）
4. **グループ旅行対応**:
   - 旅行メンバー招待
   - 支出の共有と割り勘計算
   - 誰が誰にいくら払うべきかの清算機能

5. **AI機能**:
   - 支出パターン分析
   - 予算推奨機能
   - 異常支出の検知

6. **追加分析機能**:
   - 旅行間の比較
   - トレンド分析
   - 過去の旅行データからの予算提案

7. **ソーシャル機能**:
   - 旅行レポートの共有
   - SNS連携

---

## 10. 成功指標（KPI）

### ユーザー獲得
- 初月: 100ユーザー登録
- 3ヶ月: 500ユーザー登録

### エンゲージメント
- DAU/MAU比率: 20%以上
- 1ユーザーあたりの平均旅行数: 2件以上
- 1旅行あたりの平均支出記録数: 10件以上

### 定着率
- 1週間後リテンション: 40%以上
- 1ヶ月後リテンション: 20%以上

### 機能利用率
- OCR機能利用率: 60%以上
- 予算設定率: 70%以上
- レポート閲覧率: 50%以上

---

## 11. リスクと課題

### 技術的リスク
- **OCR精度**: 多言語・手書きレシートでの精度が低い可能性
  - **対策**: 手動編集機能の充実、ユーザーフィードバックで改善

- **クロスプラットフォーム開発**: iOS/Android/Webでの一貫性
  - **対策**: デザインシステムの統一、共通のAPIエンドポイント

### ビジネスリスク
- **競合**: 既存の家計簿アプリや旅行アプリとの差別化
  - **対策**: 旅行特化、OCR機能、シンプルなUXで差別化

- **マネタイゼーション**: MVP段階では無料提供
  - **対策**: Phase 2以降でプレミアムプラン導入を検討

---

## 12. スケジュール（目安）

### Phase 1: 設計・準備（2週間）
- データベース設計
- API設計
- UI/UXデザイン（Figma）
- 技術スタックのセットアップ

### Phase 2: 開発（8週間）
- Week 1-2: 認証・旅行管理機能
- Week 3-4: 支出記録・OCR機能
- Week 5-6: レポート・分析機能
- Week 7: 予算管理機能
- Week 8: 統合テスト・バグフィックス

### Phase 3: テスト・リリース（2週間）
- ベータテスト
- ユーザーフィードバック反映
- App Store / Google Play / Web公開

---

## 13. お問い合わせ・フィードバック

本PRDに関するご質問やフィードバックがございましたら、お気軽にお知らせください。

---

**バージョン**: 1.0
**最終更新日**: 2025-12-21
**作成者**: Claude Code
